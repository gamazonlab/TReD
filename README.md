
## Introduction
To quantify the extent of reversal on disease of a specific drug, we used the cosine similarity metric. For a given disease, we first represent the set of disease signature as a vector in a high-dimensional space (whose dimension n is the total number of genes) with each nonzero element of the vector given by a disease-associated gene. The disease signature can be derived from either TWAS or DGE. The vector for each candidate drug is embedded in the same n-dimensional space. For each disease signature vector and drug response profile pair, we compute the reversal distance. Reversal distance measures a drug's ability to counteract disease-related gene expression. A positive value suggests potential preventive or therapeutic effects, while a negative value indicates the drug may worsen the disease. A higher positive reversal distance suggests a stronger counteracting effect. Let $\vec{G}$ denote a disease signature vector, $\vec{D}$ a drug profile vector, and $rd$ the reversal distance. The $rd$ quantifies the potential effect of the drug in reversing the disease signatures:

<img width="529" height="161" alt="image" src="https://github.com/user-attachments/assets/6a3f2ef5-2d81-49c5-8a1e-18318ef3c2f0" /># TReD

## Workdir
- TReS/data/DGE_rs/ : save the DGE results and processed DGE results;  
  >prestored:
  > - ALV_DE.csv (derived from the study of Brian L. Le et al)
  > - BALF.csv (derived from the study of Brian L. Le et al)
  > - EXP.csv (derived from the study of Brian L. Le et al)
- TReS/data/TWAS_rs/ : save the TWAS results and processed TWAS results;  
  >prestored:
  > - twas_blood.txt (generated by PrediXcan)
  > - twas_lung.txt (generated by PrediXcan)
  > - twas_lymphocytes.txt (generated by PrediXcan)
  > - twas_spleen.txt (generated by PrediXcan)
- TReS/data/LINCS2_beta/ : save the compound signatures downloaded from LINC2 database and processed annotation files;  
  >prestored:
  > - siginfo_beta.txt (Metadata for level 5 signatures, can be downloaded from LINCS2)
  > - compoundinfo_beta.txt (metadata for compounds, can be downloaded from LINCS2)
  > - beta_immuncelline_revised.txt (immune cell lines, can be downloaded from LINCS2)
  > - level5_beta_trt_cp_n720216x12328.gctx (level 5 compound signatures, can be downloaded from LINCS2)
- TReS/data/drugbank/ : save the drugbank vocabulary file (drugbank vocabulary_5.1.10.csv, load from drugbank);  
- TReS/data/compound_d_immune/ : save the revesal distance computed by us;  

## Tool
Predixcan(https://www.nature.com/articles/ng.3367, https://github.com/gamazonlab/MR-JTI/blob/master/model_training/predixcan/)
